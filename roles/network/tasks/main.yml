- name: 'Perform platform/version specific tasks'
  ansible.builtin.include_tasks:
    file: '{{ item }}'
  with_first_found:
    files:
      - '{{ ansible_facts["distribution"] }}{{ ansible_facts["distribution_version"] }}.yml'
      - '{{ ansible_facts["distribution"] }}{{ ansible_facts["distribution_major_version"] }}.yml'
      - '{{ ansible_facts["distribution"] }}.yml'
      - '{{ ansible_facts["os_family"] }}{{ ansible_facts["distribution_version"] }}.yml'
      - '{{ ansible_facts["os_family"] }}{{ ansible_facts["distribution_major_version"] }}.yml'
      - '{{ ansible_facts["os_family"] }}.yml'
    paths:
      - '{{ role_path }}/tasks'
    skip: true
  ignore_errors: true # TODO: this probably is a bug in the first_found lookup, according to the doc skip=true should work. else improve the ignore_errors statement
  tags:
    - 'always'


- block:

  - name: 'Disable route to the ZEROCONF network that is added to the routing table by the network initscripts'
    ansible.builtin.lineinfile:
      path: '/etc/sysconfig/network'
      line: 'NOZEROCONF=yes'
      state: 'present'

  - ansible.builtin.debug:
      msg: 'Please restart the network manually if needed.'

  tags:
    - 'network'
