- name: 'Set platform/version specific variables'
  ansible.builtin.import_role:
    name: 'shared'
    tasks_from: 'platform-variables.yml'
  tags:
    - 'always'


- block:

  - name: 'Install logrotate'
    ansible.builtin.package:
      name: 'logrotate'
      state: 'present'

  - name: 'Copy logrotate.conf template to /etc'
    ansible.builtin.template:
      src: 'etc/logrotate.conf.j2'
      dest: '/etc/logrotate.conf'
      owner: 'root'
      group: 'root'
      mode: 0o644

  - name: 'Copy system logrotate templates to /etc/logrotate.d'
    ansible.builtin.template:
      src: 'etc/logrotate.d/syslog.j2'
      dest: '/etc/logrotate.d/{{ logrotate__syslog_filename }}'
      owner: 'root'
      group: 'root'
      mode: 0o644

  tags:
    - 'logrotate'
